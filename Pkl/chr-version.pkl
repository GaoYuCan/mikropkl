import "CHR.pkl"

/// chr-version.pkl
///   - outputs RouterOS version as string, from a "release channel" like "stable" or "testing"
///   - for use from shell: `pkl eval ./Pkl/chr.version.pkl`
///   - default is stable/x86, use env vars to change: 
///       UTM_ARCHITECTURE=aarch64 CHR_VERSION=7.18.1 pkl eval ./Pkl/chr.version.pkl

// inputs from environment variables
hidden channel : String = read?("env:CHR_VERSION") ?? "stable"
hidden arch : String = read?("env:UTM_ARCHITECTURE") ?? "x86_64"

// output plain text with just version like "7.19beta4"
output {
  text = 
   new CHR.RouterOSVersion { 
    name = channel
    arch = arch
  }
  .version
  .trim()
}
